<html>
    <head>
        <title>Schedule-Post</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://unpkg.com/filepond@^4/dist/filepond.css" rel="stylesheet">
        <link rel="stylesheet" href="/static/styles.css">
    </head>
    <body id="scheduler">

        <form action="/schedule-post" method="POST" enctype="multipart/form-data" id="scheduler-form">
          <input type="text" class="file-url" name="file-url" style="display: none;">
            {% if post %}
    <input type="hidden" name="post_id" value="{{ post.id }}">
            {% endif %}

            <!-- Top Bar -->
    <div class="top-bar">
    <a href="{{ url_for('displayPosts') }}" class="text-dark text-decoration-none fw-semibold">Back</a>
    <button class="btn btn-primary btn-sm px-3" type="submit" id="postButton">Schedule</button>
  </div>

    <div class="caption-section">
    <div class="profile-section">
      <div><div class="profile-pic"></div></div>
          <textarea id="caption" class="caption-input" rows="3" placeholder="What's happening..." name="caption">{% if post and post.caption %}{{ post.caption }}{% endif %}</textarea>
    </div>
    {% if post and post.image %}
      <div class="post-media" data-media='{{ post.image | tojson | safe }}' >
          {% set file_url = post.image %}
            {% for i in file_url %}
            <div class="media-item">
            {% if i|is_image %}
      <img src="{{i}}" alt="" class="post-image"> 
          {% elif i|is_video %}
      <video src="{{i}}" class="post-image post-video" controls></video>
          {% endif %}
            </div>
          {% endfor %}
      </div>
          {% else %}
          <div class="post-media">
        <button type="button" class="btn-close" aria-label="Close" style="display: none;"></button>
          </div>
          {% endif %}
        


      
  </div>

    <div id="bottomActions" class="bottom-actions">
      <div class="views">
        <p class="date-view"></p>
        <p class="platforms-view"></p>
        <p class="upload-alert"></p>
      </div>
      <div class="actions">
        <button class="btn p-2 border-0 bg-transparent" type="button">
        <input type="file" name="image" multiple accept="image/*,video/*"  id="image-upload" hidden>
        <label for="image-upload"><img src="{{ url_for('static', filename = 'assets/image icon.png')}}" alt="upload" class="upload-image"></label>
        </button>
                
        <button class="action-btn" data-bs-toggle="modal" data-bs-target="#dateModal" type="button" id="SelectDatebtn"><img src="{{url_for('static', filename='assets/calendar-plus.svg')}}" alt=""></button>
        <button class="action-btn" type="button" data-bs-toggle="modal" data-bs-target="#platformModal" id="platformBtn"><img src="{{url_for('static', filename='assets/twitch.svg')}}" alt=""></button>
        <button class="generate-caption btn btn-primary" type="button"><img src="{{url_for('static', filename='assets/claude 1.svg')}}" alt=""><span>Ai generated caption</span></button>
      </div>
        
    </div>

    <!-- Date Modal -->
  <div class="modal fade" id="dateModal" tabindex="-1" aria-labelledby="dateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="dateModalLabel">Pick a Date</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
          <input type="datetime-local" name="time_scheduled" 
        value="{% if post and post.time_scheduled %}{{ post.time_scheduled}}{% endif %}" id="scheduledDateTime" class="form-control">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="saveDate">Save Date</button>
        </div>
      </div>
    </div>
  </div>


<!-- Platform Modal -->
<div class="modal fade" id="platformModal" tabindex="-1" aria-labelledby="platformModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="platformModalLabel">Choose Platforms</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <fieldset>
          <legend class="fs-6">Select Platforms</legend>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="platforms" value="Twitter" id="twitter" {% if post and "Twitter" in post.platform %} checked {% endif %}>
            <label class="form-check-label" for="twitter" >Twitter</label>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="platforms" value="Facebook" id="facebook" {% if post and "Facebook" in post.platform %} checked {% endif %}>
            <label class="form-check-label" for="facebook">Facebook</label>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="platforms" value="Instagram" id="instagram" {% if post and "Instagram" in post.platform %} checked {% endif %}>
            <label class="form-check-label" for="instagram">Instagram</label>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="platforms" value="LinkedIn" id="linkedin" {% if post and "LinkedIn" in post.platform %} checked {% endif %}>
            <label class="form-check-label" for="linkedin">LinkedIn</label>
          </div>
        </fieldset>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="savePlatforms">Save Selection</button>
      </div>
    </div>
  </div>
</div>
  
    </form>
       <!-- Image Preview -->
            <div id="imageOverlay">
        <button class="close-btn">
    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-arrow-left-short" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5"></path>
    </svg>
  </button>
    <div  class="gallery-content">
        <img src="" alt="Full image preview">
    </div>
        </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.12.15/dist/umd/ffmpeg.min.js"></script>
      <script src="https://unpkg.com/filepond@^4/dist/filepond.js"></script>
      <script src="/static/schduler.js"></script>
    </body>
</html>